---
title: "HW8"
author: "Getong Zhong"
date: "2023-03-27"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

```{r}
data <- read.csv("C:/Users/tonyg/Desktop/Academic/Grad/HUDM 6026/acupuncture.csv")
data$diff_pk <- data$pk1 - data$pk5
pk1_diff <- data[data$group == 1, ]$diff_pk
pk5_diff <- data[data$group == 0, ]$diff_pk

observed_diff <- mean(pk1_diff) - mean(pk5_diff)
n <- 10000
permuted_diffs <- numeric(n)

```

### permutation
```{r}
sample(data$diff_pk)
set.seed(123)  
for (i in 1:n) {
  sample_dat <- sample(data$diff_pk)
  permuted_diffs[i] <- mean(sample_dat[data$group == 1]) - mean(sample_dat[data$group == 0])
}

```

## P value
```{r}
p_value <- sum(abs(permuted_diffs) >= abs(observed_diff)) / n
p_value
```
